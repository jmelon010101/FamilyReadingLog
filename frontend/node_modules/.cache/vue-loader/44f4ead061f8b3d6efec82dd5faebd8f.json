{"remainingRequest":"/Users/musicmaster/Desktop/capstone4/capstone-family_reading/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/musicmaster/Desktop/capstone4/capstone-family_reading/frontend/src/views/Accounts.vue?vue&type=style&index=0&id=760beb20&scoped=true&lang=css&","dependencies":[{"path":"/Users/musicmaster/Desktop/capstone4/capstone-family_reading/frontend/src/views/Accounts.vue","mtime":1586821964037},{"path":"/Users/musicmaster/Desktop/capstone4/capstone-family_reading/frontend/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/musicmaster/Desktop/capstone4/capstone-family_reading/frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/musicmaster/Desktop/capstone4/capstone-family_reading/frontend/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/musicmaster/Desktop/capstone4/capstone-family_reading/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/musicmaster/Desktop/capstone4/capstone-family_reading/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouYm9sZCB7CiAgZm9udC13ZWlnaHQ6IGJvbGQ7Cn0KYnV0dG9uIHsKICBtYXJnaW4tcmlnaHQ6IDVweDsKfQpzcGFuLmJhZGdlIHsKICBtYXJnaW4tcmlnaHQ6NXB4Owp9Ci5hY3Rpb25zIC5idG57CiAgbWFyZ2luLXRvcDogMHB4Owp9Cgo="},{"version":3,"sources":["Accounts.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Accounts.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div id=\"accounts\">\n    <h3 class = \"text-center\">Family Members - {{this.family.familyname}}  </h3>\n    <table class = \"users table table-striped\">\n      <thead class=\"thead-dark\">\n      <tr>\n        <th scope=\"col\">#</th>\n        <th scope=\"col\">Username </th>\n        <th scope=\"col\">parent/child</th>\n        <th scope=\"col\"></th>\n      </tr>\n      </thead>\n      <tbody>\n        <tr class=\"users\" v-for=\"user in users\" v-bind:key=\"user.id\">\n          <td scope=\"row\">{{user.id}}</td>\n          <td>{{user.username}}</td>\n          <td>{{user.role}}</td>\n          <td>\n            <b-button v-if=\"users.length === 1\" variant=\"outline-danger\" size=\"sm\" @click=\"deleteUserId = user.id\"\n            v-b-modal.confirmDeleteFamily>Delete Family Account</b-button>\n            <b-button v-else variant=\"outline-danger\" size=\"sm\" @click=\"deleteUserId = user.id\"\n            v-b-modal.confirmDelete> Delete</b-button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  <router-link\n      :to=\"{ name: 'register', params: { role:'parent'} }\"\n      tag=\"button\"\n      class=\"btn btn-outline-primary btn-sm\"\n       >Add Parent</router-link>\n   <router-link\n      :to=\"{ name: 'register', params: { role:'child'} }\"\n        tag=\"button\"\n        class=\"btn btn-outline-primary btn-sm\"\n        >Add Child</router-link>\n    <p class=\"text-right\"> {{currentUser.familyId}}</p>\n      <!-- Modal Component -->\n  <b-modal\n    id=\"confirmDelete\"\n    title=\"Delete User\"\n    ok-title=\"Delete User\"\n    @ok=\"deleteUser\"\n  >\n    <p class=\"my-4\">Are you sure you want to delete this User? (Warning: deleting this user will \n      delete all reading activity for this user.) </p>\n  </b-modal>\n  <b-modal\n    id=\"confirmDeleteFamily\"\n    title=\"Delete Family Account\"\n    ok-title=\"Delete Family Account\"\n    @ok=\"deleteUser\"\n  >\n    <p class=\"my-4\">Are you sure you want to delete this Family Account? (Warning: deleting this family account will \n      delete all records associated with this family account.) </p>\n  </b-modal>\n  </div>\n</template>\n\n<script>\n\nimport auth from '@/auth';\n\nexport default {\n  name: 'accounts',\n   props: {\n      currentUser: Object\n    },\n   data() {\n     return {\n        users: [],\n        deleteUserId: null,\n        family: ''\n      }\n    },\n  methods: {\n    getAllUsers() {\n      fetch(`${process.env.VUE_APP_REMOTE_API}/api/users/${this.currentUser.familyId}`, {\n        method: 'GET',\n          headers: {\n          Accept: 'application/json',\n          Authorization: 'Bearer ' + auth.getToken()\n          }\n        })\n        .then((response) => {\n          return response.json()\n        })\n        .then((data) => {\n          this.users = data;\n        })\n        .catch((err)=> console.error(err)); \n    },\n   deleteUser() {\n      fetch(`${process.env.VUE_APP_REMOTE_API}/api/user/${this.deleteUserId}`, {\n        method: 'DELETE',\n        headers: {\n          Authorization: 'Bearer ' + auth.getToken(),\n        },\n        credentials: 'same-origin',\n      })\n        .then((response) => {\n          if (response.ok) {\n            const index = this.users.map((user) => user.id).indexOf(this.deleteUserId);\n            this.users.splice(index, 1);\n          }\n          this.deleteUserId = null;\n          this.getAllUsers();\n        })\n        .catch((err) => console.error(err));\n        if (this.users.length === 1) {\n          auth.logout();\n          this.$emit('update-user')\n          this.$router.push('/login');\n        }\n      },\n     getfamily() {\n      fetch(`${process.env.VUE_APP_REMOTE_API}/api/families/${this.currentUser.familyId}`, {\n        method: 'GET',\n        headers: {\n          Authorization: 'Bearer ' + auth.getToken(),\n        },\n        credentials: 'same-origin',\n        })\n        .then((response) => {\n          return response.json()\n        })\n        .then((data) => {\n          this.family = data;\n        })\n        .catch((err)=> console.error(err)); \n      }\n    },\n    created() {\n    this.getAllUsers();\n    this.getfamily();\n  }\n}\n</script>\n\n<style scoped>\n  .bold {\n    font-weight: bold;\n  }\n  button {\n    margin-right: 5px;\n  }\n  span.badge {\n    margin-right:5px;\n  }\n  .actions .btn{\n    margin-top: 0px;\n  }\n\n</style>"]}]}